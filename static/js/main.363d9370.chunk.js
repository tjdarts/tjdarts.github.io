(this.webpackJsonptjdarts=this.webpackJsonptjdarts||[]).push([[0],{106:function(e,t,n){},107:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n(0),s=n.n(a),o=n(11),c=n.n(o),i=n(145),u=n(146),l=n(78),d=n(19),h=["arcade","home"],f=[{id:"301",displayName:"301",name:"zero-one",score:301,rounds:15,platforms:h,credit:1},{id:"501",displayName:"501",name:"zero-one",score:501,rounds:20,platforms:h,credit:2},{id:"701",displayName:"701",name:"zero-one",score:701,rounds:20,platforms:h,credit:3},{id:"countUp",displayName:"Count-up",name:"count-up",rounds:8,platforms:h,credit:2},{id:"ninjaCountUp",displayName:"Ninja count-up",name:"ninja-count-up",rounds:8,platforms:h,credit:2},{id:"threeDartsOnePrize",displayName:"3 darts 1 prize",name:"3-darts-1-prize",rounds:1,platforms:[h[0]],credit:1}],m="topGames",b={platform:h[0],dartboard:"granboard",coinAcceptor:"mouse",defaultGameCategory:m,defaultGames:{topGames:[f[0],f[1],f[3],f[4],f[5]]}.topGames,maxPlayers:4,players:Object(d.a)(Array(4).keys()).map((function(e){return{name:"Player ".concat(e+1)}})),soundTheme:"default",styleTheme:"default",users:["itoyxd@gmail.com"],isArcadeMode:function(){return b.platform===h[0]},isHomeMode:function(){return b.platform===h[1]}},g=b,p=n(64),j=n(69),O=n(38);p.a.use(j.a).use(O.e).init({resources:{en:{translations:{", ":", ","01 game":"01 game","1 player":"1 player","2 players":"2 players","3 players":"3 players","4 players":"4 players","3 darts 1 prize":"3 darts 1 prize",301:"301",501:"501",701:"701",Back:"Back","Bust \ud83d\ude31":"Bust \ud83d\ude31","Connect dartboard":"Connect dartboard","Count-up":"Count-up","Game on":"Game on","Ninja count-up":"Ninja count-up","One bull":"One bull","Player 1":"Player 1","Player 2":"Player 2","Player 3":"Player 3","Player 4":"Player 4","Press \ud83d\udd34 to change player":"Press \ud83d\udd34 to change player","Press \ud83d\udd34 to next round":"Press \ud83d\udd34 to next round",Rounds:"Rounds","\ud83d\ude31 Bust \ud83d\udc94":"\ud83d\ude31 Bust \ud83d\udc94","\ud83d\ude31 You failed \ud83d\udc94":"\ud83d\ude31 You failed \ud83d\udc94",bullseyeAward:"\ud83d\udd25 {{bull}} \ud83c\udfaf",credit:"Credit: {{credit}}",moreCoins:"Need {{coins}} more coins to insert",requiredCredits:"{{credit}} credits",score:"{{score}} points",version:"Version: {{version}}",winnersAward:"\ud83c\udfc6 {{name}} wins! \u270c\ufe0f",winnersAwardForThreeDartsOnePrizeGame:"\ud83c\udfc6 {{names}} gets free credits! \u270c\ufe0f"}},zh:{translations:{", ":"\u3001","01 game":"01 \u904a\u6232","1 player":"\u4e00\u540d\u73a9\u5bb6","2 players":"\u5169\u540d\u73a9\u5bb6","3 players":"\u4e09\u540d\u73a9\u5bb6","4 players":"\u56db\u540d\u73a9\u5bb6","3 darts 1 prize":"\u53c3\u93e2\u5f97\u734e",301:"\u53c3\u96f6\u58f9",501:"\u4f0d\u96f6\u58f9",701:"\u67d2\u96f6\u58f9",Back:"\u4e0a\u4e00\u9801","Bust \ud83d\ude31":"\u7206 \ud83d\ude31","Connect dartboard":"\u9023\u63a5\u98db\u93e2\u9776","Count-up":"\u5206\u6578\u8dd1\u8d77\u4f86","Game on":"\u958b\u59cb\u904a\u6232","Ninja count-up":"\u5fcd\u8005\u306e\u624b\u88cf\u528d","One bull":"\u4e00\u96bb\u7a7f\u96f2\u7d05\u5fc3\u7bad \ud83d\ude1c","Player 1":"\u53f0\u5ba2","Player 2":"\u7063\u7063","Player 3":"\u91d1\u8001","Player 4":"\u93e2\u54e5","Press \ud83d\udd34 to change player":"\u6309 \ud83d\udd34 \u63db\u4e0b\u4e00\u500b\u73a9\u5bb6","Press \ud83d\udd34 to next round":"\u6309 \ud83d\udd34 \u5230\u4e0b\u4e00\u500b\u56de\u5408",Rounds:"\u56de\u5408","\ud83d\ude31 Bust \ud83d\udc94":"\ud83d\ude31 Bust \u6b98\u5ff5 \ud83d\udc94","\ud83d\ude31 You failed \ud83d\udc94":"\ud83d\ude31 \u5931\u6557\u4e86 \ud83d\udc94",bullseyeAward:"\ud83d\udd25 {{bull}} \ud83c\udfaf",credit:"\u9ede\u6578\uff1a{{credit}}",moreCoins:"\u9084\u9700\u8981\u6295\u5165 {{coins}} \u679a\u786c\u5e63",requiredCredits:"{{credit}} \u9ede\u6578",score:"{{score}} \u5206",version:"\u7248\u672c\uff1a{{version}}",winnersAward:"\ud83c\udfc6 {{name}}\u7372\u52dd\uff01 \u270c\ufe0f",winnersAwardForThreeDartsOnePrizeGame:"\ud83c\udfc6 {{names}}\u7372\u5f97\u4e86\u514d\u8cbb\u7684\u9ede\u6578\uff01 \u270c\ufe0f"}}},fallbackLng:"en",debug:!0,ns:["translations"],defaultNS:"translations",keySeparator:">",nsSeparator:"|",interpolation:{escapeValue:!1}});var y=p.a,v={colors:{blue:"#01befe",yellow:"#ffdd00",orange:"#ff7d00",red:"#ff006d",green:"#adff02",purple:"#8f00ff",black:"#000000"},contrastText:"#ffffff"},S=Object(l.a)({palette:{default:v,happy:v},players:[v.colors.blue,v.colors.red,v.colors.yellow,v.colors.purple],gameScore:{zIndex:1600},gameAward:{zIndex:1601},typography:{fontFamily:['"Russo One"','"Noto Serif TC"',"-apple-system","BlinkMacSystemFont",'"Segoe UI"',"Roboto",'"Helvetica Neue"',"Arial","sans-serif",'"Apple Color Emoji"','"Segoe UI Emoji"','"Segoe UI Symbol"'].join(",")},overrides:{MuiListItem:{root:{textTransform:"uppercase"}}}}),x=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,153)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,s=t.getLCP,o=t.getTTFB;n(e),r(e),a(e),s(e),o(e)}))},I=s.a.createContext(),C=n(12);function T(e){var t=Object(a.useState)(0),n=Object(C.a)(t,2),s=n[0],o=n[1];return Object(r.jsx)(I.Provider,{value:{credit:s,increaseCredit:function(e){return"number"===typeof e&&e>0&&o((function(t){return t+e}))},decreaseCredit:function(e){return"number"===typeof e&&e>0&&o((function(t){return t-e}))}},children:e.children})}var P=s.a.createContext(),w=n(3),k=function e(t){var n=this;Object(w.a)(this,e),this.timerId="",this.watch=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;n.timerId=window.setInterval((function(){n.prevArray.length!==n.array.length&&(n.prevArray=Object(d.a)(n.array),e&&"function"===typeof e&&e(n.array))}),t)},this.stop=function(){return window.clearInterval(n.timerId)},this.array=t,this.prevArray=Object(d.a)(t)},D=n(5),E=[{name:"Brandenburger Tor",url:"https://images.pexels.com/photos/2570063/pexels-photo-2570063.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=750&w=1260"},{name:"Hallstatt",url:"/resources/images/background/hallstatt.jpg"},{name:"Taipei 101",url:"https://images.pexels.com/photos/260566/pexels-photo-260566.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=750&w=1260"}],A=function(){function e(){Object(w.a)(this,e),this.imageIndex=this.randomIndex}return Object(D.a)(e,[{key:"randomIndex",get:function(){return Math.floor(Math.random()*Math.floor(E.length))}},{key:"randomImage",get:function(){var e;do{e=this.randomIndex}while(e===this.imageIndex);return this.imageIndex=e,E[e]}}]),e}(),G=n(74);var N=new(n.n(G).a),L=function e(){var t=this;Object(w.a)(this,e),this.connected=!1,this.connect=function(){return new Promise((function(e){document.addEventListener("keypress",t.handleCoinInsert),t.connected=!0,e()}))},this.disconnect=function(){return new Promise((function(e){document.removeEventListener("keypress",t.handleCoinInsert),t.connected=!1,e()}))},this.handleCoinInsert=function(e){var t=e.ctrlKey,n=e.key;!0!==t||"i"!==n&&"I"!==n||N.emit("COIN_INSERT")}},R=function e(){var t=this;Object(w.a)(this,e),this.connected=!1,this.connect=function(){return new Promise((function(e){document.ondblclick=function(){return N.emit("COIN_INSERT")},t.connected=!0,e()}))},this.disconnect=function(){return new Promise((function(e){document.ondblclick=null,t.connected=!1,e()}))}},M=function(){function e(){Object(w.a)(this,e)}return Object(D.a)(e,null,[{key:"create",value:function(e){switch(e){case"mouse":return new R;case"keyboard":default:return new L}}}]),e}(),B=n(16),U=n(24),_=n(40),H=n(32),F=n(17),z={steelTip:"steel-tip",softTip:"soft-tip"},K={builtIn:"built-in",usb:"usb",bluetooth:"bluetooth"},V=function e(){var t=this;Object(w.a)(this,e),this.type=z.softTip,this.connection=K.builtIn,this.isSteelTipType=function(){return t.type===z.steelTip},this.isSoftTipType=function(){return t.type===z.softTip},this.isBuiltInConnection=function(){return t.connection===K.builtIn},this.isUsbConnection=function(){return t.connection===K.usb},this.isBluetoothConnection=function(){return t.connection===K.bluetooth}};V.types=z,V.connections=K;var Y={841888576:"S1I",841889088:"S1O",841889344:"D1",841888832:"T1",959328576:"S2I",959328832:"S2O",942551616:"D2",959328320:"T2",925774144:"S3I",925774400:"S3O",942552128:"D3",925773888:"T3",808333632:"S4I",808334656:"S4O",808334912:"D4",808334144:"T4",892219712:"S5I",892220480:"S5O",875443776:"D5",892219968:"T5",825110592:"S6I",825111360:"S6O",875443264:"D6",825110848:"T6",211278508352:"S7I",211278509120:"S7O",942552640:"D7",211278508608:"T7",908997184:"S8I",908997952:"S8O",908998208:"D8",908997696:"T8",959329088:"S9I",959329600:"S9O",959329856:"D9",959329344:"T9",841887808:"S10I",841888320:"S10O",875443008:"D10",841888064:"T10",925774656:"S11I",925775168:"S11O",925775424:"D11",925774912:"T11",892219456:"S12I",892220736:"S12O",892220992:"D12",892220224:"T12",808333376:"S13I",808334400:"S13O",875443520:"D13",808333888:"T13",211261731648:"S14I",211261732160:"S14O",211261732416:"D14",211261731904:"T14",858665024:"S15I",858665536:"S15O",875442752:"D15",858665280:"T15",211278508096:"S16I",211278509376:"S16O",211278509632:"D16",211278508864:"T16",211261731136:"S17I",211261731392:"S17O",942551872:"D17",211261730880:"T17",825111104:"S18I",825111872:"S18O",825112128:"D18",825111616:"T18",908996928:"S19I",908997440:"S19O",942552384:"D19",908996672:"T19",858665792:"S20I",858666304:"S20O",858666560:"D20",858666048:"T20",942551104:"SBULL",875442240:"DBULL",1112821312:"CHANGE"},J=function(e){Object(B.a)(n,e);var t=Object(U.a)(n);function n(){var e;return Object(w.a)(this,n),(e=t.call(this,"GRANBOARD","442f1570-8a00-9a28-cbe1-e1d4212d53eb","442f1571-8a00-9a28-cbe1-e1d4212d53eb")).map=Y,e}return n}(function(e){Object(B.a)(n,e);var t=Object(U.a)(n);function n(e,r,a){var s,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Object(w.a)(this,n),(s=t.call(this)).connection=V.connections.bluetooth,s.valid=!0,s.map=null,s.device=null,s.characteristic=null,s.connect=function(){var e=Object(F.a)(s),t=e.device,n=e.deviceName,r=e.serviceUuid,a=e.characteristicUuid,o=e.options;if(!t||!t.gatt.connected)return navigator.bluetooth.requestDevice({filters:[{name:n},{services:[r]}]}).then((function(e){return s.device=e,o.autoReconnect&&e.addEventListener("gattserverdisconnected",s.handleDeviceAutoReconnect),e.gatt.connect()})).then((function(e){return e.getPrimaryService(r)})).then((function(e){return e.getCharacteristic(a)})).then((function(e){return s.characteristic=e,e.startNotifications()})).then((function(){return s.characteristic.addEventListener("characteristicvaluechanged",s.handleDartboardHit),Promise.resolve()}))},s.disconnect=function(){var e=Object(F.a)(s),t=e.characteristic,n=e.device,r=e.options;return t?t.stopNotifications().then((function(){return t.removeEventListener("characteristicvaluechanged",s.handleDartboardHit)})).then((function(){return n&&n.gatt.connected&&(r.autoReconnect&&n.removeEventListener("gattserverdisconnected",s.handleDeviceAutoReconnect),n.gatt.disconnect()),Promise.resolve()})):Promise.resolve()},s.handleDartboardHit=function(e){for(var t=e.target.value,n=[],r=0;r<t.byteLength;r++)n.push(("00"+t.getUint8(r).toString(16)).slice(-2));var a=s.map[parseInt("0x".concat(n.join("")))];a&&("CHANGE"!==a?N.emit("DARTBOARD_HIT",a):N.emit("CHANGE_BUTTON_CLICK"))},s.handleDeviceAutoReconnect=function(){s.device.gatt.connect()},navigator.bluetooth?(s.deviceName=e,s.serviceUuid=r,s.characteristicUuid=a,s.options=Object(_.a)({autoReconnect:!0},o),s.map={},s):(console.warn("Web Bluetooth is not supported."),Object(H.a)(s,{valid:!1}))}return Object(D.a)(n,[{key:"connected",get:function(){return this.device&&this.device.gatt.connected}}]),n}(V)),q={32:"S1I",33:"S1O",34:"D1",35:"T1",36:"S2I",37:"S2O",38:"D2",39:"T2",40:"S3I",41:"S3O",42:"D3",43:"T3",44:"S4I",45:"S4O",46:"D4",47:"T4",48:"S5I",49:"S5O",50:"D5",51:"T5",52:"S6I",53:"S6O",54:"D6",55:"T6",56:"S7I",57:"S7O",58:"D7",59:"T7",60:"S8I",61:"S8O",62:"D8",63:"T8",64:"S9I",65:"S9O",66:"D9",67:"T9",68:"S10I",69:"S10O",70:"D10",71:"T10",72:"S11I",73:"S11O",74:"D11",75:"T11",76:"S12I",77:"S12O",78:"D12",79:"T12",80:"S13I",81:"S13O",82:"D13",83:"T13",84:"S14I",85:"S14O",86:"D14",87:"T14",88:"S15I",89:"S15O",90:"D15",91:"T15",92:"S16I",93:"S16O",94:"D16",95:"T16",96:"S17I",97:"S17O",98:"D17",99:"T17",100:"S18I",101:"S18O",102:"D18",103:"T18",104:"S19I",105:"S19O",106:"D19",107:"T19",108:"S20I",109:"S20O",110:"D20",111:"T20",112:"SBULL",113:"DBULL",114:"OUT",115:"CHANGE"},Q=function(e){Object(B.a)(n,e);var t=Object(U.a)(n);function n(){var e;return Object(w.a)(this,n),(e=t.call(this)).connection=V.connections.builtIn,e.connected=!1,e.map=null,e.connect=function(){return document.addEventListener("keypress",e.handleDartboardHit),e.connected=!0,Promise.resolve()},e.disconnect=function(){return document.removeEventListener("keypress",e.handleDartboardHit),e.connected=!1,Promise.resolve()},e.handleDartboardHit=function(t){var n=Object(F.a)(e).map,r=t.key.charCodeAt(0);!1===t.ctrlKey&&r>=32&&r<=114?N.emit("DARTBOARD_HIT",n[r]):"CHANGE"===n[r]&&N.emit("CHANGE_BUTTON_CLICK")},e.map=q,e}return n}(V),W=function(){function e(){Object(w.a)(this,e)}return Object(D.a)(e,null,[{key:"create",value:function(e){switch(e){case"granboard":return new J;case"keyboard":default:return new Q}}}]),e}(),Z=y.getFixedT(),$={back:{id:"back",type:"sound",block:!1,soundEffect:"back"},bust:{id:"bust",type:"dialog",text:Z("\ud83d\ude31 Bust \ud83d\udc94"),block:!0,soundEffect:"bust"},dart:{id:"dart",type:"sound",block:!1,soundEffect:"dart"},dbull:function(e){return{id:"dbull",type:"snackbar",text:Z("bullseyeAward",{bull:e}),autoHideDuration:1500,block:!1,soundEffect:"dbull"}},fail:{id:"fail",type:"dialog",text:Z("\ud83d\ude31 You failed \ud83d\udc94"),block:!0,soundEffect:"fail"},gameOn:{id:"gameOn",type:null,block:!1},hatTrick:{id:"hatTrick",type:"animationDialog",autoHideDuration:1500,block:!1},highTon:{id:"highTon",type:"animationDialog",autoHideDuration:1500,block:!1},lowTon:{id:"lowTon",type:"animationDialog",autoHideDuration:1500,block:!1},next:{id:"next",type:"sound",block:!1,soundEffect:"next"},nextPlayer:{id:"nextPlayer",type:"dialog",text:Z("Press \ud83d\udd34 to change player"),block:!0},nextRound:{id:"nextRound",type:"dialog",text:Z("Press \ud83d\udd34 to next round"),block:!0},oneBull:{id:"oneBull",type:"animationDialog",autoHideDuration:1500,block:!1},prizeForThreeDartsOnePrizeGame:function(e){return{id:"prizeForThreeDartsOnePrizeGame",type:"dialog",text:Z("winnersAwardForThreeDartsOnePrizeGame",{names:e}),block:!0,soundEffect:"win"}},sbull:function(e){return{id:"sbull",type:"snackbar",text:Z("bullseyeAward",{bull:e}),autoHideDuration:1500,block:!1,soundEffect:"sbull"}},score:function(e){return{id:"score",type:"speech",text:Z("score",{score:e}),block:!1}},win:function(e){return{id:"win",type:"dialog",text:Z("winnersAward",{name:e}),block:!0,soundEffect:"win"}}},X=function(){function e(){Object(w.a)(this,e)}return Object(D.a)(e,null,[{key:"create",value:function(e,t){var n=null;return $[e]&&(n="function"===typeof $[e]?$[e](t):$[e]),n}}]),e}(),ee=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"OUT",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{type:"SOFT_TIP"};if(Object(w.a)(this,e),this.valid=!0,this.toValue=function(){var e,n=t.symbol,r=t.toDisplaySymbol(),a=r.slice(1,n.length);switch(r.charAt(0)){case"S":e="BULL"===a?50:parseInt(a,10);break;case"D":e="BULL"===a?50:2*parseInt(a,10);break;case"T":e=3*parseInt(a,10);break;case"O":case"B":default:e=0}return e},this.toDisplaySymbol=function(){var e=t.symbol;return"I"===e.slice(-1)||"O"===e.slice(-1)?e.slice(0,e.length-1):e},!e.isValid(n))return{valid:!1};this.symbol=n,this.index=r,this.options=a,this.displaySymbol=this.toDisplaySymbol(),this.value=this.toValue()}return Object(D.a)(e,null,[{key:"isValid",value:function(e){var t=!1;if(/^S\d{1,2}I$/.test(e)||/^S\d{1,2}O$/.test(e)){var n=parseInt(e.slice(1,e.length-1),10);t=n>=1&&n<=20}else if(/^[DT]\d{1,2}$/.test(e)){var r=parseInt(e.slice(1,e.length),10);t=r>=1&&r<=20}else(/^[SD]BULL$/.test(e)||"OUT"===e||"BUST"===e)&&(t=!0);return t}},{key:"isInnerSingle",value:function(t){return e.isValid(t)&&t.startsWith("S")&&t.endsWith("I")}}]),e}(),te=function e(t,n){var r=this;Object(w.a)(this,e),this.scores=[],this.addScore=function(e){try{if(r.isNewScoreAddable()){var t;if(e instanceof ee?(t=e).index=r.scores.length:t=new ee(e,r.scores.length,r.options),!t.valid)throw new Error("The `score` is invalid!");return r.scores.push(t),t}throw new Error("The `scores` array cannot contain more than 3 Score objects!")}catch(n){return console.error(n),null}},this.getCurrentScore=function(){return r.scores[r.scores.length-1]},this.isNewScoreAddable=function(){return r.scores.length<3&&!r.scores.some((function(e){return"BUST"===e.symbol}))},this.index=t,this.options=n},ne=function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(w.a)(this,e),this.rounds=[],this.addScore=function(e){var t=n.getCurrentRound();return t&&t.isNewScoreAddable()||(t=n.addRound()),t?t.addScore(e):null},this.addRound=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new te(n.rounds.length,n.options);try{if(!(n.rounds.length<n.roundsLength))throw new Error("The `rounds` array cannot contain more than ".concat(n.roundsLength," Round objects!"));return n.rounds.push(e),e}catch(t){return console.error(t),null}},this.getCurrentRound=function(){return n.rounds[n.rounds.length-1]},this.removeCurrentRound=function(){return n.rounds.pop()},this.isLastRoundFinished=function(){var e=n.getCurrentRound();return n.rounds.length===n.roundsLength&&e&&!e.isNewScoreAddable()},this.roundsLength=t,this.options=r},re=function(){function e(){Object(w.a)(this,e)}return Object(D.a)(e,null,[{key:"isBullseye",value:function(e){return"SBULL"===e.symbol||"DBULL"===e.symbol}},{key:"getMessage",value:function(t){var n=null;if(t instanceof ee)if(e.isBullseye(t)){var r=t.symbol.toLowerCase();n=X.create(r,r)}else n=X.create("dart");else if(t instanceof te){var a=t.scores,s=se(a),o=ae(a);s<100&&1===o?n=X.create("oneBull"):s>=100&&s<150||3===o||s>=151||(n=X.create("score",s))}return n}}]),e}(),ae=function(e){var t=0;return e.forEach((function(e){return("SBULL"===e.symbol||"DBULL"===e.symbol)&&t++})),t},se=function(e){var t=0;return e.forEach((function(e){return t+=e.toValue()})),t},oe=n(75),ce=n(10),ie=function(){function e(t,n){var r=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Object(w.a)(this,e),this.currentPlayerIndex=-1,this.currentPlayerDartScores=[],this.gameScores=[],this.messages=[],this.players=[],this.scoreboards=[],this.isLastRoundFinished=function(){return r.scoreboards[r.players.length-1].isLastRoundFinished()},this.addScoreForCurrentPlayer=function(e){var t=r.scoreboards[r.currentPlayerIndex].addScore(e);return t?(r.currentPlayerDartScores.length<3?r.currentPlayerDartScores=r.currentPlayerDartScores.concat(t):r.currentPlayerDartScores=[t],t):null},this.addRoundForCurrentPlayer=function(e){var t=r.scoreboards[r.currentPlayerIndex].addRound(e);return t&&(r.currentPlayerDartScores=t.scores),t},this.deleteCurrentRoundForCurrentPlayer=function(){var e=r.scoreboards[r.currentPlayerIndex].removeCurrentRound(),t=r.scoreboards[r.currentPlayerIndex].getCurrentRound();return r.currentPlayerDartScores=t?t.scores:[],e},this.addMessage=function(e){return e&&(r.messages=r.messages.concat(e))},this.deleteMessage=function(e){var t=r.messages.findIndex((function(t){return t.id=e}));-1!==t&&r.messages.splice(t,1)},this.clearMessages=function(){return r.messages=[]},this.setCurrentPlayerIndex=function(e){return r.currentPlayerIndex=e},this.setCurrentPlayerGameScore=function(e){return r.gameScores[r.currentPlayerIndex]=e},this.increaseCurrentPlayerGameScore=function(e){return r.setCurrentPlayerGameScore(r.currentPlayerGameScore+e)},this.decreaseCurrentPlayerGameScore=function(e){return r.setCurrentPlayerGameScore(r.currentPlayerGameScore-e)},Object(ce.e)(this,{currentPlayerIndex:ce.f,currentPlayerDartScores:ce.f,gameScores:ce.f,messages:ce.f,players:ce.f,scoreboards:ce.f,currentPlayer:ce.c,currentPlayerGameScore:ce.c,currentPlayerScoreboard:ce.c,addScoreForCurrentPlayer:ce.b,addRoundForCurrentPlayer:ce.b,deleteCurrentRoundForCurrentPlayer:ce.b,addMessage:ce.b,deleteMessage:ce.b,clearMessages:ce.b,setCurrentPlayerIndex:ce.b,setCurrentPlayerGameScore:ce.b,increaseCurrentPlayerGameScore:ce.b,decreaseCurrentPlayerGameScore:ce.b}),this.players=t,t.forEach((function(e,t){r.scoreboards[t]=new ne(n),r.scoreboards[t].addRound(),r.gameScores[t]=a})),this.currentPlayerIndex=0}return Object(D.a)(e,[{key:"currentPlayer",get:function(){return this.players[this.currentPlayerIndex]}},{key:"currentPlayerGameScore",get:function(){return this.gameScores[this.currentPlayerIndex]}},{key:"currentPlayerScoreboard",get:function(){return this.scoreboards[this.currentPlayerIndex]}},{key:"lastPlayer",get:function(){return this.players[this.players.length-1]}},{key:"lastPlayerScoreboard",get:function(){return this.scoreboards[this.players.length-1]}}]),e}(),ue=function(){function e(){Object(w.a)(this,e)}return Object(D.a)(e,null,[{key:"has",value:function(e){return g.users.includes(e)}}]),e}(),le={isLogined:!0},de={isLogined:!1},he=function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"91304192363-7fr8mvjp3ph628joqchr32d1iu2lr38l.apps.googleusercontent.com",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"https://tjdarts.github.io";Object(w.a)(this,e),this.auth=function(){return n.isLogined().then((function(e){if(!e.isLogined){var t,r={},a=new URLSearchParams(window.location.hash.substring(1)),s=Object(oe.a)(a);try{for(s.s();!(t=s.n()).done;){var o=Object(C.a)(t.value,2),c=o[0],i=o[1];r[c]=i}}catch(u){s.e(u)}finally{s.f()}if(Object.keys(r).length>0){if(localStorage.setItem(n.storageItemName,JSON.stringify(r)),r.state&&"try_sample_request"===r.state)return n.isLogined()}else n.openSignInForm()}return Promise.resolve(e)}))},this.isLogined=function(){return new Promise((function(e){"none"===navigator.connection.type&&(new me("offline-token").auth()?e(le):e(de));var t=JSON.parse(localStorage.getItem(n.storageItemName));if(t&&t.access_token){var r=new XMLHttpRequest;r.open("GET","https://people.googleapis.com/v1/people/me?personFields=emailAddresses&access_token=".concat(t.access_token)),r.onreadystatechange=function(){try{if(4===r.readyState)if(200===r.status){var t=JSON.parse(r.response).emailAddresses[0].value;ue.has(t)?e(le):e(de)}else e(de)}catch(n){console.error(n),e(de)}},r.send(null)}else e(de)}))},this.openSignInForm=function(){var e=document.createElement("form");e.setAttribute("method","GET"),e.setAttribute("action","https://accounts.google.com/o/oauth2/v2/auth");var t={client_id:n.clientId,redirect_uri:n.redirectUri,scope:"profile https://www.googleapis.com/auth/user.emails.read",state:"try_sample_request",response_type:"token"};for(var r in t){var a=document.createElement("input");a.setAttribute("type","hidden"),a.setAttribute("name",r),a.setAttribute("value",t[r]),e.appendChild(a)}document.body.appendChild(e),e.submit()},this.storageItemName=t,this.clientId=r,this.redirectUri=a},fe=n(60),me=function e(t){var n=this;Object(w.a)(this,e),this.auth=function(){var e=!1;try{var t=localStorage.getItem(n.storageItemName);if(t){var r=fe.KEYUTIL.getKey("-----BEGIN PUBLIC KEY-----MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAqOyWDJ0ngQQ0jOxmSBi4IOuonz6A9Ipi/AK9rXw6Pnyd5ji1800AygLavE4ZdQIYOvthAKNmAfBA00on5VmnmwHqUDmYvS3hJTSKJFGbjkEzyl+KUQoKA2AvlLmHhjVdegwxYwmgnrkAKCeMNOHA5V7ITFMLaEnTGjviingdP2RMrMBFooBHQOZL7k5uTqz8CH+yvS5/Y/eIkFPSUzqAWKNMLASUJfmQ/Sfo74+pLz0FJYY6diUdi4vx0yj93ADG1A9VF8YQ2CkorOoPwEvTRi7V8rW91H8zh1eP9IDfBgOnRjgtCiNyIlBfUWEaR6J/SIHJC8eYcyFCMDFcqinRuQIDAQAB-----END PUBLIC KEY-----");e=fe.KJUR.jws.JWS.verifyJWT(t,r,{alg:["RS256"]})}return e}catch(a){return e}},this.storageItemName=t},be=y.getFixedT(),ge=function(){function e(t){Object(w.a)(this,e),this._players=t}return Object(D.a)(e,[{key:"players",get:function(){return this._players.map((function(e,t){return{name:be(e.name),index:t}}))}}]),e}(),pe=n(61),je={default:["back","bust","coin","dart","dbull","fail","game_on","hover","next","press","sbull","warn","win"],ninja:["bgm","dart","sbull","dbull"],"3-darts-1-prize":["bgm"]},Oe=new function e(){var t=this;Object(w.a)(this,e),this.theme="default",this.soundEffects={},this.play=function(e){return new Promise((function(n){!t.soundEffects[e]&&n(),t.soundEffects[e].on("end",n),t.soundEffects[e].play()}))},this.stop=function(e){return t.soundEffects[e]&&t.soundEffects[e].stop()},this.setTheme=function(e){je[e]&&(t.theme=e),t.loadSoundEffects()},this.loadSoundEffects=function(){je[t.theme].forEach((function(e){t.soundEffects[e]=new pe.Howl({src:["/resources/sound-effects/".concat(t.theme,"/").concat(e,".webm")],volume:"bgm"===e?.2:1,loop:"bgm"===e}),t.soundEffects[e].on("loaderror",(function(){t.soundEffects[e]=new pe.Howl({src:["/resources/sound-effects/default/".concat(e,".webm")],volume:"bgm"===e?.2:1,loop:"bgm"===e})}))}))},this.setTheme(this.theme),g.soundTheme&&"default"!==g.soundTheme&&this.setTheme(g.soundTheme)},ye=window.speechSynthesis,ve=function(){function e(t){var n=this;Object(w.a)(this,e),this.speak=function(e){if(ye&&!ye.speaking){var t=new SpeechSynthesisUtterance(e);t.voice=n.voice,ye.speak(t)}},this.lang=t,this.voices=ye.getVoices()}return Object(D.a)(e,[{key:"voice",get:function(){var e=this.lang,t=this.voices,n=e.includes("zh")?"Google \u570b\u8a9e\uff08\u81fa\u7063\uff09":"Daniel",r=t.findIndex((function(e){return e.name===n}));return r?t[r]:t[0]}}]),e}(),Se=new A;function xe(e){var t=Object(a.useState)(Se.randomImage),n=Object(C.a)(t,2),s=n[0],o=n[1];return Object(r.jsx)(P.Provider,{value:{backgroundImage:s,setBackgroundImage:o,setRandomBackgroundImage:function(){return o(Se.randomImage)}},children:e.children})}var Ie=s.a.createContext();function Ce(e){var t=Object(a.useState)({isLogined:!1}),n=Object(C.a)(t,2),s=n[0],o=n[1];return Object(a.useEffect)((function(){var e=new he("oauth2-tjdart-params");window.oauth=e,e.auth().then((function(e){return o(e)}))}),[o]),Object(r.jsx)(Ie.Provider,{value:s,children:e.children})}var Te=n(29),Pe=n(14),we=n(77),ke=n(151),De=n(135),Ee=n(137),Ae=n(37),Ge=function(e){return{score:{color:function(t){return"".concat(e.players[t.index],"e0")},fontSize:"27rem",textShadow:"-10px 0 white, 0 10px white, 10px 0 white, 0 -10px white"}}},Ne=Object(De.a)(Ge);function Le(e){var t=e.score,n=e.index,a=Ne({index:n});return Object(r.jsx)(Ae.a,{className:a.score,variant:"h1",align:"center",children:t})}var Re=function(e){return{gameName:{margin:"24px",textTransform:"uppercase",textShadow:"-3px 0 white, 0 3px white, 3px 0 white, 0 -3px white"},gameScore:{display:"flex",justifyContent:"center",alignItems:"center",position:"fixed",zIndex:e.gameScore.zIndex,top:0,left:0,width:"100%",height:"100%"},scoreboard:{float:"left",marginLeft:"24px"},scores:{float:"right",width:"220px"},playerCards:{position:"fixed",bottom:0,left:0}}},Me=Object(De.a)(Re);function Be(e){var t=e.name,n=e.player,a=e.players,s=e.dartScores,o=e.scoreboard,c=e.gameScore,i=e.gameScores,u=Object(ke.a)().t,l=Me();return Object(r.jsxs)("div",{children:[Object(r.jsx)("div",{className:l.gameScore,children:Object(r.jsx)(Le,{index:n.index,name:n.name,score:c})}),Object(r.jsx)(zt,{className:l.gameName,variant:"h4",align:"center",children:u(t)}),Object(r.jsx)(Mt,{className:l.scoreboard,index:n.index,rounds:o.rounds,totalRounds:o.roundsLength}),Object(r.jsx)(_t,{className:l.scores,scores:s}),Object(r.jsx)(Ee.a,{container:!0,className:l.playerCards,spacing:3,children:a.map((function(e,t){return Object(r.jsx)(Ee.a,{item:!0,xs:3,children:Object(r.jsx)(Dt,{index:t,name:e.name,score:i[t],active:t===n.index})},t)}))})]})}var Ue=n(138),_e=n(139);function He(e){var t=e.appState,n=g.defaultGames,s=g.platform,o=Object(Pe.g)(),c=Object(ke.a)().t,i=Object(a.useState)(Object.keys(t.game).length?n.findIndex((function(e){return e.id===t.game.id})):0),u=Object(C.a)(i,2),l=u[0],d=u[1];return Object(r.jsx)(Ue.a,{children:Object(r.jsx)(vt,{selectedIndex:l,setSelectedIndex:d,children:n.filter((function(e){return e.platforms.includes(s)})).map((function(e,n){return Object(r.jsx)(_e.a,{selected:n===l,onMouseOver:function(){return Oe.play("hover")},onClick:function(){return function(e){Oe.play("press"),t.game=e,o.push("/game-menu/players")}(e)},children:Object(r.jsx)(zt,{variant:"h2",children:c(e.displayName)})},n)}))})})}var Fe=new ge(g.players);function ze(e){var t=e.appState,n=Object(Pe.g)(),s=Object(a.useContext)(I).credit,o=Fe.players,c=Object(a.useState)(t.players.length?t.players.length-1:0),i=Object(C.a)(c,2),u=i[0],l=i[1],h=Object(ke.a)().t,f=new ve(y.language),m=g.isArcadeMode;return Object(r.jsx)(Ue.a,{children:Object(r.jsxs)(vt,{selectedIndex:u,setSelectedIndex:l,children:[Object(d.a)(Array(o.length).keys()).map((function(e){return Object(r.jsxs)(_e.a,{selected:e===u,onMouseOver:function(){return Oe.play("hover")},onClick:function(){return function(e){var r=s-t.game.credit*e.length;m()&&r<0?Oe.play("warn").then((function(){return f.speak(h("moreCoins",{coins:Math.abs(r)}))})):(Oe.play("game_on"),t.players=e,n.push("/game"))}(o.slice(0,e+1))},children:[Object(r.jsx)(zt,{variant:"h2",children:h("".concat(e+1," player").concat(e>0?"s":""))}),m()&&Object(r.jsx)(zt,{style:{marginLeft:"24px"},variant:"h5",children:h("requiredCredits",{credit:t.game.credit*o.slice(0,e+1).length})})]},e)})),Object(r.jsx)(_e.a,{selected:o.length===u,onMouseOver:function(){return Oe.play("hover")},onClick:function(){Oe.play("back"),n.push("/game-menu/games")},children:Object(r.jsx)(zt,{variant:"h3",children:h("Back")})})]})})}var Ke=function(e){return{root:{margin:"24px"}}},Ve=Object(De.a)(Ke);function Ye(e){var t=e.appState,n=Ve(),a=Object(Pe.h)().step,s=function(e){switch(e.step){case"games":return Object(r.jsx)(He,{appState:t});case"players":return Object(r.jsx)(ze,{appState:t});default:return null}};return Object(r.jsx)("div",{className:n.root,children:Object(r.jsx)(s,{step:a})})}var Je=n(147),qe={UNINITIALIZED:0,INITIALIZED:1,STARTED:2,RESUMED:3,PAUSED:4,STOPPED:5},Qe=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{rounds:8,score:0};Object(w.a)(this,e),this.state=null,this.status=qe.UNINITIALIZED,this.start=function(){(n.isInitialized()||n.isStopped())&&(n.addListeners(),N.on("CHANGE_BUTTON_CLICK",n.handleChangeButtonClick),n.status=qe.STARTED,n.resume())},this.resume=function(){(n.isStarted()||n.isPaused())&&(N.on("DARTBOARD_HIT",n.handleDartboardHit),n.status=qe.RESUMED)},this.pause=function(){n.isResumed()&&(N.off("DARTBOARD_HIT",n.handleDartboardHit),n.status=qe.PAUSED)},this.stop=function(){(n.isStarted()||n.isResumed()||n.isPaused())&&(N.off("DARTBOARD_HIT",n.handleDartboardHit),N.off("CHANGE_BUTTON_CLICK",n.handleChangeButtonClick),n.removeListeners(),n.status=qe.STOPPED)},this.addListeners=function(){N.on("GAME_START",n.start),N.on("GAME_RESUME",n.resume),N.on("GAME_PAUSE",n.pause),N.on("GAME_STOP",n.stop)},this.removeListeners=function(){N.off("GAME_START",n.start),N.off("GAME_RESUME",n.resume),N.off("GAME_PAUSE",n.pause),N.off("GAME_STOP",n.stop)},this.isInitialized=function(){return n.status===qe.INITIALIZED},this.isStarted=function(){return n.status===qe.STARTED},this.isResumed=function(){return n.status===qe.RESUMED},this.isPaused=function(){return n.status===qe.PAUSED},this.isStopped=function(){return n.status===qe.STOPPED},this.onDartboardHit=function(e){},this.onChangeButtonClick=function(){},this.onGameOver=function(){},this.handleDartboardHit=function(e){var t=n.state,r=t.addScoreForCurrentPlayer,a=t.currentPlayerScoreboard,s=r(e);s&&(n.state.addMessage(re.getMessage(s)),2===s.index&&n.state.addMessage(re.getMessage(a.getCurrentRound())),n.onDartboardHit(s))},this.handleChangeButtonClick=function(){n.isLastRound()?n.handleGameOver():(n.onChangeButtonClick(),n.switchToNextPlayer())},this.switchToNextPlayer=function(){var e=(n.state.currentPlayerIndex+1)%n.players.length;n.state.setCurrentPlayerIndex(e),n.resume()},this.handleGameMessageOnClose=function(e){e.block&&n.resume(),n.state.deleteMessage(e.id)},this.handleGameOver=function(){if(0===n.state.messages.length)n.addGameMessage("win",n.winners[0].name);else{var e=new k(n.state.messages);e.watch((function(t){0===t.length&&(n.addGameMessage("win",n.winners[0].name),e.stop())}))}n.pause(),N.off("CHANGE_BUTTON_CLICK",n.handleChangeButtonClick),n.onGameOver()},this.isLastRound=function(){return n.state.currentPlayer===n.state.lastPlayer&&n.state.lastPlayerScoreboard.rounds.length===n.options.rounds},this.addGameMessage=function(e,t){var r=X.create(e,t);r&&(r.block&&n.pause(),n.state.addMessage(r))},this.clearGameMessages=function(){return n.state.clearMessages()},this.players=t,this.options=r,this.state=new ie(t,r.rounds,r.score),this.status=qe.INITIALIZED}return Object(D.a)(e,[{key:"winners",get:function(){return[]}}]),e}();Qe.statuses=qe;var We=function(e){Object(B.a)(n,e);var t=Object(U.a)(n);function n(){var e;Object(w.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).onDartboardHit=function(t){var n=e.state,r=n.currentPlayerScoreboard,a=n.increaseCurrentPlayerGameScore,s=n.isLastRoundFinished;a(t.value);var o=r.getCurrentRound();s()?e.handleGameOver():o&&2===o.getCurrentScore().index&&e.addGameMessage("nextPlayer")},e.onChangeButtonClick=function(){var t=e.state,n=t.addRoundForCurrentPlayer,r=t.clearMessages;n(),r(),e.addGameMessage("next")},e}return Object(D.a)(n,[{key:"winners",get:function(){var e=this,t=this.state.players.map((function(t,n){return{name:t.name,score:e.state.gameScores[n]}})).sort((function(e,t){return t.score-e.score}));return t.filter((function(e){return e.score===t[0].score}))}}]),n}(Qe);function Ze(e){var t=e.players,n=e.rounds,o=Object(Pe.g)();0===t.length&&o.push("/game-menu");var c=Object(a.useMemo)((function(){return new We(t,{rounds:n})}),[t,n]);Object(a.useEffect)((function(){c.isInitialized()&&(c.start(),c.onGameOver=function(){N.once("CHANGE_BUTTON_CLICK",(function(){c.clearGameMessages(),c.addGameMessage("back"),c.stop(),N.emit("GAME_OVER",We.name,c.winners),o.push("/game-menu")}))})}),[c,o]);var i=Object(Je.a)((function(e){var t=e.game.state,n=t.currentPlayer,a=t.currentPlayerGameScore,s=t.currentPlayerDartScores,o=t.currentPlayerScoreboard,c=t.players,i=t.gameScores;return Object(r.jsx)(Be,{name:"Count-up",player:n,gameScore:a,dartScores:s,scoreboard:o,players:c,gameScores:i})})),u=Object(Je.a)((function(e){var t=e.game,n=t.state.messages;return Object(r.jsx)(yt,{messages:n,onClose:t.handleGameMessageOnClose})}));return Object(r.jsxs)(s.a.Fragment,{children:[Object(r.jsx)(i,{game:c}),Object(r.jsx)(u,{game:c})]})}var $e=function(e){Object(B.a)(n,e);var t=Object(U.a)(n);function n(){var e;Object(w.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).handleDartboardHit=function(t){var n=e.state,r=n.addScoreForCurrentPlayer,a=n.currentPlayerScoreboard,s=ee.isInnerSingle(t)?"SBULL":"SBULL"===t?"DBULL":t,o=r(new ee(s));o&&("DBULL"===o.symbol&&(o.value=100),e.state.addMessage(re.getMessage(o)),2===o.index&&e.state.addMessage(re.getMessage(a.getCurrentRound())),e.onDartboardHit(o))},e}return n}(We);function Xe(e){var t=e.players,n=e.rounds,o=Object(Pe.g)(),c=Object(a.useContext)(P),i=c.backgroundImage,u=c.setBackgroundImage;0===t.length&&o.push("/game-menu");var l=Object(a.useMemo)((function(){return new $e(t,{rounds:n})}),[t,n]);Object(a.useEffect)((function(){if(l.isInitialized()){var e=Object(_.a)({},i),t=Oe.theme;u({name:"ninja",url:"/resources/images/background/ninja.png"}),Oe.setTheme("ninja"),Oe.play("bgm"),l.start(),l.onGameOver=function(){N.once("CHANGE_BUTTON_CLICK",(function(){l.clearGameMessages(),l.addGameMessage("back"),l.stop(),u(e),Oe.stop("bgm"),Oe.setTheme(t),N.emit("GAME_OVER",$e.name,l.winners),o.push("/game-menu")}))}}}),[l,o,i,u]);var d=Object(Je.a)((function(e){var t=e.game.state,n=t.currentPlayer,a=t.currentPlayerGameScore,s=t.currentPlayerDartScores,o=t.currentPlayerScoreboard,c=t.players,i=t.gameScores;return Object(r.jsx)(Be,{name:"Ninja count-up",player:n,gameScore:a,dartScores:s,scoreboard:o,players:c,gameScores:i})})),h=Object(Je.a)((function(e){var t=e.game,n=t.state.messages;return Object(r.jsx)(yt,{messages:n,onClose:t.handleGameMessageOnClose})}));return Object(r.jsxs)(s.a.Fragment,{children:[Object(r.jsx)(d,{game:l}),Object(r.jsx)(h,{game:l})]})}var et=y.getFixedT(),tt=function(e){Object(B.a)(n,e);var t=Object(U.a)(n);function n(){var e;Object(w.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).onDartboardHit=function(t){var n=e.state,r=n.currentPlayerScoreboard,a=n.increaseCurrentPlayerGameScore,s=n.isLastRoundFinished;a(t.value);var o=r.getCurrentRound();s()?e.handleGameOver():o&&2===o.getCurrentScore().index&&e.addGameMessage("nextPlayer")},e.onChangeButtonClick=function(){var t=e.state,n=t.addRoundForCurrentPlayer,r=t.clearMessages;n(),r(),e.addGameMessage("next")},e.handleGameOver=function(){if(0===e.state.messages.length)e.addGameResultMessage();else{var t=new k(e.state.messages);t.watch((function(n){0===n.length&&(e.addGameResultMessage(),t.stop())}))}e.pause(),N.off("CHANGE_BUTTON_CLICK",e.handleChangeButtonClick),e.onGameOver()},e.addGameResultMessage=function(){var t=e.winners.map((function(e){return e.name})),n=1===t.length?t[0]:t.join(et(", "));t.length?e.addGameMessage("prizeForThreeDartsOnePrizeGame",n):e.addGameMessage("fail")},e}return Object(D.a)(n,[{key:"winners",get:function(){var e=this.state,t=e.gameScores,n=e.players,r=e.scoreboards,a=[];return t.forEach((function(e,t){(e>65||e<21)&&3===r[t].rounds[0].scores.length&&r[t].rounds[0].scores.every((function(e){return e.value>0}))&&a.push(t)})),a.map((function(e){return n[e]}))}}]),n}(Qe);function nt(e){var t=e.players,n=e.rounds,o=Object(Pe.g)(),c=Object(a.useContext)(I).increaseCredit;0===t.length&&o.push("/game-menu");var i=Object(a.useMemo)((function(){return new tt(t,{rounds:n})}),[t,n]);Object(a.useEffect)((function(){if(i.isInitialized()){var e=Oe.theme;Oe.setTheme("3-darts-1-prize"),Oe.play("bgm"),i.start(),i.onGameOver=function(){i.winners.length&&c(2*i.winners.length),N.once("CHANGE_BUTTON_CLICK",(function(){i.clearGameMessages(),i.addGameMessage("back"),i.stop(),Oe.stop("bgm"),Oe.setTheme(e),N.emit("GAME_OVER",tt.name,i.winners),o.push("/game-menu")}))}}}),[c,i,o]);var u=Object(Je.a)((function(e){var t=e.game.state,n=t.currentPlayer,a=t.currentPlayerGameScore,s=t.currentPlayerDartScores,o=t.currentPlayerScoreboard,c=t.players,i=t.gameScores;return Object(r.jsx)(Be,{name:"3 darts 1 prize",player:n,gameScore:a,dartScores:s,scoreboard:o,players:c,gameScores:i})})),l=Object(Je.a)((function(e){var t=e.game,n=t.state.messages;return Object(r.jsx)(yt,{messages:n,onClose:t.handleGameMessageOnClose})}));return Object(r.jsxs)(s.a.Fragment,{children:[Object(r.jsx)(u,{game:i}),Object(r.jsx)(l,{game:i})]})}var rt=function(e){Object(B.a)(n,e);var t=Object(U.a)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{score:301,rounds:15};return Object(w.a)(this,n),(r=t.call(this,e,a)).onDartboardHit=function(e){var t=r.state,n=t.isLastRoundFinished,a=t.currentPlayerScoreboard;(0,t.decreaseCurrentPlayerGameScore)(e.value);var s=a.getCurrentRound(),o=r.state.currentPlayerGameScore;0===o||n()?r.handleGameOver():o>0&&s&&2===s.getCurrentScore().index?r.addGameMessage("nextPlayer"):o<0&&r.addGameMessage("bust")},r.onChangeButtonClick=function(){var e=r.state,t=e.addRoundForCurrentPlayer,n=e.clearMessages,a=e.currentPlayerGameScore,s=e.deleteCurrentRoundForCurrentPlayer,o=e.increaseCurrentPlayerGameScore;if(n(),a<0){var c=s();o(c.scores.map((function(e){return e.value})).reduce((function(e,t){return e+t}))),(c=new te(c.index)).addScore("BUST"),t(c)}t(),r.addGameMessage("next")},r}return Object(D.a)(n,[{key:"winners",get:function(){var e=this,t=this.state.players.map((function(t,n){return{name:t.name,score:e.state.gameScores[n]}})).sort((function(e,t){return e.score-t.score}));return t.filter((function(e){return e.score===t[0].score}))}}]),n}(Qe);function at(e){var t=e.players,n=e.rounds,o=e.score,c=Object(Pe.g)();0===t.length&&c.push("/game-menu");var i=Object(a.useMemo)((function(){return new rt(t,{score:o,rounds:n})}),[t,o,n]);Object(a.useEffect)((function(){i.isInitialized()&&(i.start(),i.onGameOver=function(){N.once("CHANGE_BUTTON_CLICK",(function(){i.clearGameMessages(),i.addGameMessage("back"),i.stop(),N.emit("GAME_OVER",rt.name,i.winners),c.push("/game-menu")}))})}),[i,c]);var u=Object(Je.a)((function(e){var t=e.game.state,n=t.currentPlayer,a=t.currentPlayerGameScore,s=t.currentPlayerDartScores,o=t.currentPlayerScoreboard,c=t.players,i=t.gameScores;return Object(r.jsx)(Be,{name:"01 game",player:n,gameScore:a,dartScores:s,scoreboard:o,players:c,gameScores:i})})),l=Object(Je.a)((function(e){var t=e.game,n=t.state.messages;return Object(r.jsx)(yt,{messages:n,onClose:t.handleGameMessageOnClose})}));return Object(r.jsxs)(s.a.Fragment,{children:[Object(r.jsx)(u,{game:i}),Object(r.jsx)(l,{game:i})]})}function st(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{game:{},players:[]},t=e.game,n=e.players,s=Object(Pe.g)(),o=Object(a.useContext)(P),c=o.setRandomBackgroundImage;switch(Object(a.useEffect)((function(){"ninja-count-up"!==t.name&&c()}),[]),t.name){case"zero-one":return Object(r.jsx)(at,{players:n,score:t.score,rounds:t.rounds});case"count-up":return Object(r.jsx)(Ze,{players:n,rounds:t.rounds});case"ninja-count-up":return Object(r.jsx)(Xe,{players:n,rounds:t.rounds});case"3-darts-1-prize":return Object(r.jsx)(nt,{players:n,rounds:t.rounds});default:return s.push("/"),null}}var ot=n(149),ct=function(e){return{text:{textTransform:"uppercase"},snackbar:{width:"100%"},snackbarContent:{color:"#000",backgroundColor:"#fff"}}},it=Object(De.a)(ct);function ut(e){var t=e.message,n=e.onClose,s=it(),o=Object(a.useState)(!0),c=Object(C.a)(o,2),i=c[0],u=c[1];return Object(a.useEffect)((function(){u(!0),t.soundEffect&&Oe.play(t.soundEffect)}),[t]),Object(r.jsx)(ot.a,{anchorOrigin:{vertical:"top",horizontal:"center"},className:s.snackbar,open:i,autoHideDuration:t.autoHideDuration,onClose:function(){u(!1),n&&n(t)},message:Object(r.jsx)(Ae.a,{className:s.text,variant:"h1",children:t.text}),ContentProps:{className:s.snackbarContent}})}var lt=n(148),dt=n(140),ht=function(e){return{text:{textTransform:"uppercase"},dialogScrollPaper:{alignItems:"flex-end"}}},ft=Object(De.a)(ht);function mt(e){var t=e.message,n=ft();return Object(a.useEffect)((function(){t.soundEffect&&Oe.play(t.soundEffect)}),[t]),Object(r.jsx)(lt.a,{open:!0,maxWidth:!1,classes:{scrollPaper:n.dialogScrollPaper},children:Object(r.jsx)(dt.a,{children:Object(r.jsx)(Ae.a,{className:n.text,variant:"h1",children:t.text})})})}var bt=function(e){return{root:function(t){return{position:"fixed",zIndex:e.gameAward.zIndex,top:0,left:0,width:"100%",height:"100%",color:"white",backgroundColor:"black",display:"flex",justifyContent:"center",alignItems:"center",backgroundImage:"url(".concat(t.backgroundImageUrl,")"),backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundSize:"cover"}},text:{textTransform:"capitalize"}}},gt=Object(De.a)(bt);function pt(e){var t=e.message,n=e.onClose,s=Object(a.useState)(!0),o=Object(C.a)(s,2),c=o[0],i=o[1],u=Object(ke.a)().t,l=Object(a.useContext)(P).backgroundImage,d=gt({backgroundImageUrl:l.url});return Object(a.useEffect)((function(){var e=setTimeout((function(){i(!1),n&&n(t)}),t.autoHideDuration);return function(){return clearTimeout(e)}}),[t,n,i]),c?Object(r.jsx)("div",{className:d.root,children:Object(r.jsx)(zt,{className:d.text,variant:"h1",children:u("One bull")})}):null}function jt(e){var t=e.message,n=e.onClose;switch(t.id){case"oneBull":return Object(r.jsx)(pt,{message:t,onClose:n});case"lowTon":case"hatTrick":default:return null}}function Ot(e){var t=e.message,n=e.onClose,a=new ve(y.language);switch(t.type){case"snackbar":return Object(r.jsx)(ut,{message:t,onClose:n});case"dialog":return Object(r.jsx)(mt,{message:t,onClose:n});case"animationDialog":return Object(r.jsx)(jt,{message:t,onClose:n});case"speech":return a.speak(t.text),n&&n(t),null;case"sound":default:return t.soundEffect&&Oe.play(t.soundEffect),n&&n(t),null}}function yt(e){var t=e.messages,n=e.onClose;return Object(r.jsx)(s.a.Fragment,{children:t.map((function(e,t){return Object(r.jsx)(Ot,{message:e,onClose:n},t)}))})}function vt(e){var t=e.children,n=e.selectedIndex,r=e.setSelectedIndex;return Object(a.useEffect)((function(){var e=[],a=[],s=function t(n){var r=0;return n.type===_e.a?(r++,e.push(n.props.onMouseOver),a.push(n.props.onClick)):Array.isArray(n)&&n.forEach((function(n){n.type===_e.a?(r++,e.push(n.props.onMouseOver),a.push(n.props.onClick)):Array.isArray(n)&&(r+=t(n))})),r}(t),o=function(){r((n+1)%s),"function"===typeof e[n]&&e[n]()},c=function(e){return("SBULL"===e||"DBULL"===e)&&"function"===typeof a[n]&&a[n]()};return N.on("CHANGE_BUTTON_CLICK",o),N.on("DARTBOARD_HIT",c),function(){N.off("CHANGE_BUTTON_CLICK",o),N.off("DARTBOARD_HIT",c)}}),[n]),t}var St=W.create(g.dartboard);function xt(){var e=Object(ke.a)().t,t=Object(Pe.g)();return Object(r.jsxs)(Ue.a,{children:[Object(r.jsx)(_e.a,{onClick:function(){St.connect().then((function(){return St.connected&&t.push("/game-menu")}))},children:Object(r.jsx)(Ae.a,{variant:"h2",children:e("Connect dartboard")})}),Object(r.jsx)(_e.a,{children:Object(r.jsx)(Ae.a,{variant:"h6",children:e("version",{version:"0.1.55"})})})]})}var It=n(141),Ct=n(142),Tt=n(150),Pt=n(143),wt=function(e){return{root:{color:function(e){return e.active?"#ffffff":"#aaaaaa"},backgroundColor:function(e){return e.active?"#000000dd":"#00000066"}},avatar:{backgroundColor:function(t){return"".concat(e.players[t.index])}},score:{textAlign:"center"}}},kt=Object(De.a)(wt);function Dt(e){var t=e.name,n=e.score,a=e.index,s=e.active,o=kt({index:a,active:s});return Object(r.jsxs)(It.a,{className:o.root,children:[Object(r.jsx)(Ct.a,{avatar:Object(r.jsx)(Tt.a,{className:o.avatar,children:t.charAt(0).toUpperCase()}),title:Object(r.jsx)(Ae.a,{variant:"h4",children:t})}),Object(r.jsx)(Pt.a,{className:o.score,children:Object(r.jsx)(Ae.a,{variant:"h4",children:n})})]})}var Et=n(108),At=n(111),Gt=n(144);function Nt(e){var t=e.index,n=e.round,a=e.score;return Object(r.jsx)(zt,{style:a>=100?{color:"".concat(S.players[t])}:{},variant:"h5",children:"".concat(n,". ").concat(a)})}var Lt=function(e){return{round:{paddingLeft:0}}},Rt=Object(De.a)(Lt);function Mt(e){var t=e.className,n=e.index,a=e.rounds,s=e.totalRounds,o=Object(ke.a)().t,c=Rt(),i=a.slice(-8);return Object(r.jsx)("div",{className:t,children:Object(r.jsxs)(Et.a,{children:[Object(r.jsx)(At.a,{className:c.round,children:Object(r.jsx)(Gt.a,{primary:Object(r.jsx)(zt,{variant:"h4",children:"".concat(a.length," / ").concat(s," ").concat(o("Rounds"))})})}),Object(d.a)(Array(i.length).keys()).map((function(e){return Object(r.jsx)(At.a,{className:c.round,children:Object(r.jsx)(Gt.a,{primary:0===i[e].scores.length?Object(r.jsx)(zt,{variant:"h5",children:"".concat(i[e].index+1,".")}):"BUST"===i[e].scores[0].displaySymbol?Object(r.jsx)(zt,{variant:"h5",children:"".concat(i[e].index+1,". ").concat(o("Bust \ud83d\ude31"))}):Object(r.jsx)(Nt,{index:n,round:i[e].index+1,score:i[e].scores.map((function(e){return e.value})).reduce((function(e,t){return e+t}))})})},e)})).reverse()]})})}var Bt=function(e){return{text:{marginLeft:"1rem",textShadow:"-3px 0 white, 0 3px white, 3px 0 white, 0 -3px white"}}},Ut=Object(De.a)(Bt);function _t(e){var t=e.className,n=e.scores,a=Ut();return Object(r.jsx)(Et.a,{className:t,children:n.map((function(e,t){return Object(r.jsx)(At.a,{children:Object(r.jsx)(Gt.a,{primary:Object(r.jsx)(Ae.a,{className:a.text,variant:"h4",children:"".concat(t+1,". ").concat(e.displaySymbol)})})},t)}))})}var Ht=n(8),Ft={root:{color:"black",textShadow:"-3px 0 white, 0 3px white, 3px 0 white, 0 -3px white"}};function zt(e){var t=Object(Ht.a)(Ft)(Ae.a);return Object(r.jsx)(t,Object(_.a)({},e))}var Kt=n(9),Vt=function(e){return{root:function(t){var n;return n={height:"100vh",overflowX:"hidden"},Object(Kt.a)(n,e.breakpoints.between("sm","xl"),{overflowY:"hidden"}),Object(Kt.a)(n,"backgroundImage","url(".concat(t.backgroundImageUrl,")")),Object(Kt.a)(n,"backgroundPosition","center"),Object(Kt.a)(n,"backgroundRepeat","no-repeat"),Object(Kt.a)(n,"backgroundSize","cover"),n},credit:{position:"fixed",bottom:"24px",right:"24px"}}},Yt={game:{},players:[]},Jt=Object(we.a)(),qt=Object(De.a)(Vt);function Qt(){var e=g.isArcadeMode,t=Object(a.useContext)(Ie),n=Object(a.useContext)(I),o=n.credit,c=n.increaseCredit,i=n.decreaseCredit,u=Object(a.useContext)(P).backgroundImage,l=Object(ke.a)().t,d=qt({backgroundImageUrl:u.url});return Object(a.useEffect)((function(){var t=W.create(g.dartboard),n=M.create(g.coinAcceptor),r=function(){c(1),Oe.play("coin")},a=function(t,n){if(i(Yt.game.credit*Yt.players.length),e()){var r=g.defaultGames.find((function(e){return"threeDartsOnePrize"===e.id}));r&&(r.platforms="ThreeDartsOnePrizeGame"===t&&n.length?[]:["arcade"])}};return t.isBluetoothConnection()?Jt.push("/options"):t.connect(),e()&&(n.connect(),N.on("COIN_INSERT",r),N.on("GAME_OVER",a)),function(){t.disconnect(),e()&&(n.disconnect(),N.off("COIN_INSERT",r),N.off("GAME_OVER",a))}}),[]),Object(r.jsx)("div",{className:d.root,children:t.isLogined&&Object(r.jsx)(Te.a,{children:Object(r.jsxs)(Pe.d,{children:[Object(r.jsx)(Pe.b,{path:"/game-menu/:step",render:function(){return Object(r.jsxs)(s.a.Fragment,{children:[Object(r.jsx)(Ye,{appState:Yt}),e()&&Object(r.jsx)(zt,{className:d.credit,variant:"h4",children:l("credit",{credit:o})})]})}}),Object(r.jsx)(Pe.b,{path:"/game",render:function(){return Object(r.jsx)(st,{game:Yt.game,players:Yt.players})}}),Object(r.jsx)(Pe.b,{path:"/options",render:function(){return Object(r.jsx)(xt,{})}}),Object(r.jsx)(Pe.b,{render:function(){return Object(r.jsx)(Pe.a,{to:"/game-menu/games"})}})]})})})}n(106);y.changeLanguage(g.language||window.navigator.userLanguage||window.navigator.language),c.a.render(Object(r.jsx)(s.a.StrictMode,{children:Object(r.jsx)(i.a,{i18n:y,children:Object(r.jsx)(u.a,{theme:Object(l.a)(S),children:Object(r.jsx)(Ce,{children:Object(r.jsx)(T,{children:Object(r.jsx)(xe,{children:Object(r.jsx)(Qt,{})})})})})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js"),x()}},[[107,1,2]]]);
//# sourceMappingURL=main.363d9370.chunk.js.map